#!/bin/bash

# Ferramentas essenciais para manter um servidor Minecraft Bedrock sempre ativo.
# Este pacote fornece uma coleção de ferramentas e scripts necessários para garantir
# que um servidor Minecraft Bedrock esteja sempre ativo e funcionando de forma estável.
# Inclui suporte para reinicialização automática, backups regulares, e monitoramento
# de desempenho.
#
# Desenvolvido por Isac Gondim.
# Todos os direitos autorais reservados.
# LinkedIn: https://www.linkedin.com/in/isac-gondim-07a836227/
#
# Utilização:
# 1. Configure as variáveis de ambiente conforme necessário.
# 2. Execute este script para iniciar o servidor Minecraft Bedrock e as ferramentas associadas.
#

# Configurações do servidor
MINECRAFT_DIR=""
BACKUP_DIR="/opt/backup-server-bedrock"
SCREEN_NAME="minecraft_bedrock_server"
SERVER_EXECUTABLE="bedrock_server"

start_server() {
    echo "Iniciando servidor Minecraft Bedrock..."
    screen -dmS $SCREEN_NAME $MINECRAFT_DIR/$SERVER_EXECUTABLE
    echo "Servidor Minecraft Bedrock iniciado."
}

stop_server() {
    echo "Parando servidor Minecraft Bedrock..."
    screen -S $SCREEN_NAME -X stuff "stop^M"
    sleep 10
    screen -S $SCREEN_NAME -X quit
    echo "Servidor Minecraft Bedrock parado."
}

backup_server() {
    echo "Realizando backup do servidor Minecraft Bedrock..."
    rsync -av --delete $MINECRAFT_DIR $BACKUP_DIR
    echo "Backup concluído."
}

schedule_tasks() {
    echo "Agendando tarefas automáticas..."
    (crontab -l ; echo "0 3 * * * /path/to/this/script/minecraft-bedrock-server-tools.sh backup") | crontab -
    echo "Tarefas agendadas."
}

case "$1" in
    start)
        start_server
        ;;
    stop)
        stop_server
        ;;
    backup)
        backup_server
        ;;
    schedule)
        schedule_tasks
        ;;
    *)
        echo "Uso: $0 {start|stop|backup|schedule}"
        exit 1
        ;;
esac

exit 0
